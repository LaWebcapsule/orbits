"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[2401],{3010:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>d,frontMatter:()=>i,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"main-documentation/quick-start","title":"Quickstart","description":"This is a basic guide to get your first resource working.","source":"@site/docs/main-documentation/quick-start.md","sourceDirName":"main-documentation","slug":"/main-documentation/quick-start","permalink":"/orbits/docs/main-documentation/quick-start","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2,"title":"Quickstart"},"sidebar":"tutorialSidebar","previous":{"title":"Introduction","permalink":"/orbits/docs/main-documentation/intro"},"next":{"title":"Core Concepts","permalink":"/orbits/docs/category/core-concepts"}}');var s=o(4848),r=o(8453);const i={sidebar_position:2,title:"Quickstart"},c="Hello world",a={},l=[{value:"Install",id:"install",level:2},{value:"Write your first action",id:"write-your-first-action",level:2},{value:"Consume your action",id:"consume-your-action",level:3},{value:"Use the action anywhere you want in your app",id:"use-the-action-anywhere-you-want-in-your-app",level:4},{value:"Configure persistent storage",id:"configure-persistent-storage",level:4},{value:"Hook : ensure your app is set",id:"hook--ensure-your-app-is-set",level:4},{value:"Workflow: a chain of actions",id:"workflow-a-chain-of-actions",level:2},{value:"Consume your workflow",id:"consume-your-workflow",level:3},{value:"Resources : a complete lifecycle",id:"resources--a-complete-lifecycle",level:2},{value:"Consume your resources",id:"consume-your-resources",level:3}];function u(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"hello-world",children:"Hello world"})}),"\n",(0,s.jsx)(n.p,{children:"This is a basic guide to get your first resource working."}),"\n",(0,s.jsx)(n.h2,{id:"install",children:"Install"}),"\n",(0,s.jsxs)(n.p,{children:["Install ",(0,s.jsx)(n.code,{children:"@wbce/orbits-core"})," and ",(0,s.jsx)(n.code,{children:"@wbce/orbits-fuel"}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"npm install @wbce/orbits-core @wbce/orbits-fuel --save\n"})}),"\n",(0,s.jsx)(n.p,{children:"Install it with yarn:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"yarn add @wbce/orbits-core @wbce/orbits-fuel\n"})}),"\n",(0,s.jsx)(n.h2,{id:"write-your-first-action",children:"Write your first action"}),"\n",(0,s.jsxs)(n.p,{children:["An ",(0,s.jsx)(n.a,{href:"/orbits/docs/main-documentation/core-concepts/action",children:(0,s.jsx)(n.code,{children:"Action"})})," is an object that encapsulate a mutating process."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",metastring:"title='src/orbits/my-action.ts'",children:'import {Action} from "@wbce/orbits-core"\n\nexport class MyAction extends Action{\n\n    main(){\n        console.log("hello");\n        this.setResult("hello!")\n        return ActionState.Success;\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"consume-your-action",children:"Consume your action"}),"\n",(0,s.jsx)(n.h4,{id:"use-the-action-anywhere-you-want-in-your-app",children:"Use the action anywhere you want in your app"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",metastring:"title='src/anywhere-in-your-app.ts'",children:"  const action = new MyAction();\n  await action.save();//the action will be executed in the background.\n  await Action.trackActionAsPromise(action, [ActionState.SUCCESS, ActionState.ERROR]);//this line is optional.\n"})}),"\n",(0,s.jsx)(n.h4,{id:"configure-persistent-storage",children:"Configure persistent storage"}),"\n",(0,s.jsxs)(n.p,{children:["You will need a mongodb connection to store the state of your action.\nOnce you have a valid mongodb url, please create an ",(0,s.jsx)(n.code,{children:"ActionApp"})," with the mongodb connection string."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",metastring:"title='src/orbits/orbi.ts'",children:"const db = {\n    protocol: 'mongodb+srv',\n    url: process.env['MONGO_URL'],\n    name: 'orbits-test',\n    connectQsParams: '?retryWrites=true&w=majority',\n};\n\nnew ActionApp({\n    db: {\n        mongo: {\n            url: `${db.protocol || 'mongodb'}://${db.url}/${db.name}${db.connectQsParams}`,\n            opts: {},\n        },\n    }\n})\n"})}),"\n",(0,s.jsx)(n.h4,{id:"hook--ensure-your-app-is-set",children:"Hook : ensure your app is set"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",metastring:"title='src/index.ts'",children:'import {ActionApp} from "@wbce/orbits-core"\nimport "./orbits/action-app.ts"\n\n\n    await ActionApp.waitForActiveApp;\n'})}),"\n",(0,s.jsx)(n.h2,{id:"workflow-a-chain-of-actions",children:"Workflow: a chain of actions"}),"\n",(0,s.jsxs)(n.p,{children:["You will quickly want to exploit the result of your action and not just launch a process in background.\nTo do this, you need to write a ",(0,s.jsx)(n.a,{href:"/orbits/docs/main-documentation/core-concepts/workflow",children:(0,s.jsx)(n.code,{children:"Workflow"})}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",metastring:"title='src/orbits/my-workflow.ts'",children:'import {Workflow} from "@wbce/orbits-core"\nimport {MyAction} from "./my-action.js"\n\nexport class MyWorkflow extends Workflow{\n\n    IArgument: {\n        name : string\n    }\n\n    define(){\n        const resultOfMyAction = await this.do("hello", new MyAction());\n        const name = await this.do("name", ()=>{\n            return Promise.resolve(this.argument.name)\n        })\n        console.log(`${resultOfMyAction}, ${name}!`)\n        return `${resultOfMyAction}, ${name}!`\n    }\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:["Of course, you don't need this to display hello name, but this is for the example.\nHere, using ",(0,s.jsx)(n.code,{children:"this.do"})," we ensure that, for each execution of ",(0,s.jsx)(n.code,{children:"MyWorkflow"}),', the "hello" step is run once and only once.\nThis allows to apply the SEGA principle.']}),"\n",(0,s.jsx)(n.h3,{id:"consume-your-workflow",children:"Consume your workflow"}),"\n",(0,s.jsx)(n.p,{children:"A workflow is an action, so you consume it like an action"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",metastring:"title='src/anywhere-in-your-app.ts'",children:'  const workflow = new MyWorkflow().setArgument({name : "John Doe"});\n  await workflow.save();//the action will be executed in the background.\n  await Action.trackActionAsPromise(workflow, [ActionState.SUCCESS, ActionState.ERROR]);//this line is optional.\n'})}),"\n",(0,s.jsx)(n.h2,{id:"resources--a-complete-lifecycle",children:"Resources : a complete lifecycle"}),"\n",(0,s.jsx)(n.p,{children:"Greetings occurs only once in a day but if you do :"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",metastring:"title='src/consume-workflow.ts'",children:'    const workflow1 = new MyWorkflow().setArgument({name : "John Doe"});\n    await workflow1.save();//the action will be executed in the background.\n    //others processes\n    const workflow2 = new MyWorkflow().setArgument({name : "John Doe"});\n    await workflow1.save();\n'})}),"\n",(0,s.jsxs)(n.p,{children:["the workflow will run twice. How do you do to have it run once ?\nThis is managed by the concept of ",(0,s.jsx)(n.a,{href:"/orbits/docs/main-documentation/core-concepts/resource",children:(0,s.jsx)(n.code,{children:"Resource"})}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",metastring:"title='src/orbits/my-resource.ts'",children:'    export class MyGreetings extends Resource{\n        IArgument: {\n            name : string\n            date: string\n        }\n\n        identity(){\n            return `${this.argument.name}-${this.argument.date}`\n        }\n\n        defineInstall(){\n            //say hello\n            await this.do("hello", new MyWorkflow().setArgument({\n                name: this.argument.name\n            }))\n        }\n\n        defineUpdate(){\n            //do nothing, I already have seen you\n        }\n\n        defineUninstall(){\n            //say goodbye\n            const goodbye = await this.do("goodbye", ()=>{\n                console.log("goodbye")\n                return "goodbye ; it was a great day";\n            })\n            return `${goodbye} ${this.argument.name}`\n        }\n\n    }\n'})}),"\n",(0,s.jsx)(n.h3,{id:"consume-your-resources",children:"Consume your resources"}),"\n",(0,s.jsx)(n.p,{children:"A resource is an action, so you consume it like an action"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",metastring:"title='src/anywhere-in-your-app.ts'",children:'  const resource = new MyGreetings().setArgument({\n    name: "John Doe",\n    date: "01-01-01"\n  });\n  await resource.save();//the action will be executed in the background. the greetings will appear in the console\n  await Action.trackActionAsPromise(resource, [ActionState.SUCCESS, ActionState.ERROR]); \n  \n  const resource2 = new MyGreetings().setArgument({\n    name: "John Doe",\n    date: "01-01-01"\n  });\n  await resource2.save();//the action will be executed but nothing will appear in the console.log, as we already installed the resource\n  await Action.trackActionAsPromise(resource2, [ActionState.SUCCESS, ActionState.ERROR]); \n\n  const resource3 = new MyGreetings().setArgument({\n    name: "John Doe",\n    date: "01-01-01"\n  }).setCommand("goodbye");\n  await resource2.save();//the action will be executed ; "goodbye" will appear in the console\n  await Action.trackActionAsPromise(resource2, [ActionState.SUCCESS, ActionState.ERROR]);\n'})})]})}function d(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(u,{...e})}):u(e)}},8453:(e,n,o)=>{o.d(n,{R:()=>i,x:()=>c});var t=o(6540);const s={},r=t.createContext(s);function i(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);