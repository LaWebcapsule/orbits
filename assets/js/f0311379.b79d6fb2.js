"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[2401],{3010:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>d,frontMatter:()=>r,metadata:()=>o,toc:()=>l});const o=JSON.parse('{"id":"main-documentation/quick-start","title":"Quickstart","description":"This is a basic guide to get your first resource working.","source":"@site/docs/main-documentation/quick-start.md","sourceDirName":"main-documentation","slug":"/main-documentation/quick-start","permalink":"/docs/main-documentation/quick-start","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2,"title":"Quickstart"},"sidebar":"tutorialSidebar","previous":{"title":"Tutorial Intro","permalink":"/docs/main-documentation/intro"},"next":{"title":"Action","permalink":"/docs/main-documentation/core-concepts/action"}}');var i=t(4848),s=t(8453);const r={sidebar_position:2,title:"Quickstart"},a="Hello world",c={},l=[{value:"Configure persistent storage",id:"configure-persistent-storage",level:2},{value:"Consume the action in your app",id:"consume-the-action-in-your-app",level:2},{value:"Hook : ensure your app is set",id:"hook--ensure-your-app-is-set",level:3},{value:"Use the action anywhere you want in your app",id:"use-the-action-anywhere-you-want-in-your-app",level:3},{value:"What if you want to chain actions ?",id:"what-if-you-want-to-chain-actions-",level:2},{value:"Consume the workflow",id:"consume-the-workflow",level:2},{value:"What if you want to do the greeting only once ?",id:"what-if-you-want-to-do-the-greeting-only-once-",level:2},{value:"Consume your resources",id:"consume-your-resources",level:2}];function u(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"hello-world",children:"Hello world"})}),"\n",(0,i.jsx)(n.p,{children:"This is a basic guide to get your first resource working."}),"\n",(0,i.jsx)(n.h1,{id:"install",children:"Install"}),"\n",(0,i.jsxs)(n.p,{children:["Install ",(0,i.jsx)(n.code,{children:"@wbce/orbits-core"})," and ",(0,i.jsx)(n.code,{children:"@wbce/orbits-fuel"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"npm install @wbce/orbits-core @wbce/orbits-fuel --save\n"})}),"\n",(0,i.jsx)(n.p,{children:"Install it with yarn:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"yarn add @wbce/orbits-core @wbce/orbits-fuel\n"})}),"\n",(0,i.jsx)(n.h1,{id:"write-you-first-action",children:"Write you first action"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",metastring:"title='src/orbits/my-action.ts'",children:'import {Action} from "@wbce/orbits-core"\n\nexport class MyAction extends Action{\n\n    IArgument: {\n\n    }\n\n    IResult: {\n\n    }\n\n    main(){\n        console.log("hello");\n        this.setResult("hello!")\n        return ActionState.Success;\n    }\n}\n'})}),"\n",(0,i.jsx)(n.h1,{id:"import-your-action-in-your-code",children:"Import your action in your code"}),"\n",(0,i.jsx)(n.h2,{id:"configure-persistent-storage",children:"Configure persistent storage"}),"\n",(0,i.jsxs)(n.p,{children:["You will need a mongodb connection to store the state of your action.\nOnce you have a valid mongodb url, please create an ",(0,i.jsx)(n.code,{children:"ActionApp"})," with the mongodb connection string."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",metastring:"title='src/orbits/orbi.ts'",children:"const db = {\n    protocol: 'mongodb+srv',\n    url: process.env['MONGO_URL'],\n    name: 'orbits-test',\n    connectQsParams: '?retryWrites=true&w=majority',\n};\n\nnew ActionApp({\n    db: {\n        mongo: {\n            url: `${db.protocol || 'mongodb'}://${db.url}/${db.name}${db.connectQsParams}`,\n            opts: {},\n        },\n    }\n})\n"})}),"\n",(0,i.jsx)(n.h2,{id:"consume-the-action-in-your-app",children:"Consume the action in your app"}),"\n",(0,i.jsx)(n.h3,{id:"hook--ensure-your-app-is-set",children:"Hook : ensure your app is set"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",metastring:"title='src/index.ts'",children:'import {ActionApp} from "@wbce/orbits-core"\nimport "./orbits/action-app.ts"\n\n\n    await ActionApp.waitForActiveApp;\n'})}),"\n",(0,i.jsx)(n.h3,{id:"use-the-action-anywhere-you-want-in-your-app",children:"Use the action anywhere you want in your app"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",metastring:"title='src/consume-action.ts'",children:"  const action = new MyAction();\n  await action.save();//the action will be executed in the background.\n  await Action.trackActionAsPromise(action, [ActionState.SUCCESS, ActionState.ERROR]);//this line is optional.\n"})}),"\n",(0,i.jsx)(n.h2,{id:"what-if-you-want-to-chain-actions-",children:"What if you want to chain actions ?"}),"\n",(0,i.jsx)(n.p,{children:"You will quickly want to exploit the result of your action and not just launch a process in background.\nTo do this, you need to write a workflow."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",metastring:"title='src/orbits/my-workflow.ts'",children:'import {Workflow} from "@wbce/orbits-core"\nimport {MyAction} from "./my-action.js"\n\nexport class MyWorkflow extends Workflow{\n\n    IArgument: {\n        name : string\n    }\n\n    define(){\n        const resultOfMyAction = await this.do("hello", new MyAction());\n        const name = await this.do("name", ()=>{\n            return Promise.resolve(this.argument.name)\n        })\n        console.log(`${resultOfMyAction}, ${name}!`)\n        return `${resultOfMyAction}, ${name}!`\n    }\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Of course, you don't need this to display hello name, but this is for the example.\nHere, using ",(0,i.jsx)(n.code,{children:"this.do"})," we ensure that, for each execution of ",(0,i.jsx)(n.code,{children:"MyWorkflow"}),', the "hello" step is run once and only once.\nThis allows to apply the SEGA principle.']}),"\n",(0,i.jsx)(n.h2,{id:"consume-the-workflow",children:"Consume the workflow"}),"\n",(0,i.jsx)(n.p,{children:"A workflow is an action, so you consume it like an action"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",metastring:"title='src/consume-workflow.ts'",children:"  const workflow = new MyWorkflow();\n  await workflow.save();//the action will be executed in the background.\n  await Action.trackActionAsPromise(workflow, [ActionState.SUCCESS, ActionState.ERROR]);//this line is optional.\n"})}),"\n",(0,i.jsx)(n.h2,{id:"what-if-you-want-to-do-the-greeting-only-once-",children:"What if you want to do the greeting only once ?"}),"\n",(0,i.jsx)(n.p,{children:"Greetings occurs only once in a day but if I do :"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",metastring:"title='src/consume-workflow.ts'",children:'    const workflow1 = new MyWorkflow().setArgument({name : "John Doe"});\n    await workflow1.save();//the action will be executed in the background.\n    //others processes\n    const workflow2 = new MyWorkflow().setArgument({name : "John Doe"});\n    await workflow1.save();\n'})}),"\n",(0,i.jsx)(n.p,{children:'the workflow will run twice. How do I do to have it run once ?\nThis is managed by the concept of "Resource".'}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",metastring:"title='src/orbits/my-resource.ts'",children:'    export class MyGreetings extends Resource{\n        IArgument: {\n            name : string\n            date: string\n        }\n\n        identity(){\n            return `${this.argument.name}-${this.argument.date}`\n        }\n\n        defineInstall(){\n            await this.do("hello", new MyWorkflow().setArgument({\n                name: this.argument.name\n            }))\n        }\n\n        defineUpdate(){\n            //do nothing, I already have seen you\n        }\n\n        defineUninstall(){\n            //say goodbye\n            const goodbye = await this.do("goodbye", ()=>{\n                console.log("goodbye")\n                return "goodbye ; it was a great day";\n            })\n            return `${goodbye} ${this.argument.name}`\n        }\n\n    }\n'})}),"\n",(0,i.jsx)(n.h2,{id:"consume-your-resources",children:"Consume your resources"}),"\n",(0,i.jsx)(n.p,{children:"A resource is an action, so you consume it like an action"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",metastring:"title='src/consume-resource.ts'",children:'  const resource = new MyGreetings().setArgument({\n    name: "John Doe",\n    date: "01-01-01"\n  });\n  await resource.save();//the action will be executed in the background. the greetings will appear in the console\n  await Action.trackActionAsPromise(resource, [ActionState.SUCCESS, ActionState.ERROR]); \n  \n  const resource2 = new MyGreetings().setArgument({\n    name: "John Doe",\n    date: "01-01-01"\n  });\n  await resource2.save();//the action will be executed but nothing will appear in the console.log, as we already installed the resource\n  await Action.trackActionAsPromise(resource2, [ActionState.SUCCESS, ActionState.ERROR]); \n\n  const resource3 = new MyGreetings().setArgument({\n    name: "John Doe",\n    date: "01-01-01"\n  }).setCommand("goodbye");\n  await resource2.save();//the action will be executed ; "goodbye" will appear in the console\n  await Action.trackActionAsPromise(resource2, [ActionState.SUCCESS, ActionState.ERROR]);\n'})}),"\n",(0,i.jsx)(n.h1,{id:"next-steps",children:"Next steps"})]})}function d(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(u,{...e})}):u(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>a});var o=t(6540);const i={},s=o.createContext(i);function r(e){const n=o.useContext(s);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),o.createElement(s.Provider,{value:n},e.children)}}}]);